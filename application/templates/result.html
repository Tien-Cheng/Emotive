<!-- Inherits from layout.html -->
{% extends "layout.html" %}

<!-- The block content replace the one encapsulated in  layout.html -->
{% block content %}

<!-- Congrats -->
<div>
    <h4 class="header-main mb-4 d-flex justify-content-center">
        <span>Our AI thinks you're </span>
        <span class="text-purple ms-2 d-flex align-items-center justify-content-center">{{history.emotion.capitalize()}} 
            <img class="ms-2" src="{{url_for('static', filename='assets/'+history.emotion+'.svg')}}" alt="emotion-icons">
        </span>
    </h4>
</div>

<div class="d-flex align-items-center justify-content-center">

    <!-- Image -->
    <div class="image-result rounded me-5" style="background-image: url({{url_for('static', filename='uploads/' + history.file_path)}})"></div>

    <!-- Prediction Probabilities -->
    <div class="image-data-wrapper d-flex flex-column align-items-stretch justify-content-between">
        <h5 class="mb-0 fw-bold"  style="color: grey;">
            <span class="text-dark"">Photo Taken:</span> {{history.predicted_on.strftime('%I:%M %p %A, %M %B %Y')}}
        </h5>

        <!-- Probabilities -->
        <div class="probabilities d-flex flex-column align-items-stretch justify-content-between">
            {% for emotion, prob in history.prediction %}
                <div class="d-flex align-items-center justify-content-start">
                    <div class="bg-purple-light ps-3 py-2 rounded-pill icon-emotion d-flex align-items-center" style="width: 130px;">
                        <img class="me-2" src="{{url_for('static', filename='assets/'+emotion+'.svg')}}" alt="emotion-icons">
                        <span class="text-purple fw-bold">{{emotion}}</span>
                    </div>
                    <div class="bg-purple-light py-2" style="width: 60px">
                        <span class="text-purple fw-bold">|</span>
                        <span class="text-purple fw-bold">{{(prob*100) | round(precision=1)}}%</span>
                    </div>
                    <div class="bg-purple-light pe-3 py-2 rounded-pill icon-emotion-right"
                         style="width: calc({{prob}} * 300px + 20px)">
                        <span style="color: #ffffff00">|</span>
                    </div>
                </div>
            {% endfor %}
        </div>

        <div class="row">
            <a class="col-6" href="/predict"><button class="btn bg-purple w-100 text-white">Take Again</button></a>
            <a class="col-6" href="/history"><button class="btn bg-purple w-100 text-white">Go to History</button></a>
        </div>
    </div>


</div>

<style>
    .image-result {
        height: 500px;
        width: 500px;
        background-position: center;
        background-repeat: no-repeat;
        background-size: cover;
        box-shadow: 0px 3px 15px rgba(0, 0, 0, 0.1);
    }

    .image-data-wrapper {
        height: 500px;
        width: 500px;
    }

    .probabilities {
        height: 380px;
    }

    .icon-emotion {
        border-top-right-radius: 0px !important;
        border-bottom-right-radius: 0px !important;
    }

    .icon-emotion-right {
        border-top-left-radius: 0px !important;
        border-bottom-left-radius: 0px !important;
    }
</style>

{% endblock %}